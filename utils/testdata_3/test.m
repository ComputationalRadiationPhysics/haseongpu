beta_cell = zeros(size(p,1),mesh_z);
beta_cell(i_p,i_z) = crystal.tfluo*(dndt_pump(i_p,i_z)-dndt_ASE(i_p,i_z))*(1-exp(-time_int/crystal.tfluo))+beta_cell(i_p,i_z)*exp(-time_int/crystal.tfluo);
beta_cell(i_p,i_z) = crystal.tfluo*(dndt_pump(i_p,i_z)-dndt_ASE(i_p,i_z))*(1-exp(-time_int/crystal.tfluo))+beta_cell(i_p,i_z)*exp(-time_int/crystal.tfluo);
beta_cell(i_p,i_z) = crystal.tfluo*(dndt_pump(i_p,i_z)-dndt_ASE(i_p,i_z))*(1-exp(-time_int/crystal.tfluo))+beta_cell(i_p,i_z)*exp(-time_int/crystal.tfluo);
beta_cell(i_p,i_z) = crystal.tfluo*(dndt_pump(i_p,i_z)-dndt_ASE(i_p,i_z))*(1-exp(-time_int/crystal.tfluo))+beta_cell(i_p,i_z)*exp(-time_int/crystal.tfluo);
beta_cell(i_p,i_z) = crystal.tfluo*(dndt_pump(i_p,i_z)-dndt_ASE(i_p,i_z))*(1-exp(-time_int/crystal.tfluo))+beta_cell(i_p,i_z)*exp(-time_int/crystal.tfluo);
beta_cell(i_p,i_z) = crystal.tfluo*(dndt_pump(i_p,i_z)-dndt_ASE(i_p,i_z))*(1-exp(-time_int/crystal.tfluo))+beta_cell(i_p,i_z)*exp(-time_int/crystal.tfluo);
beta_cell(i_p,i_z) = crystal.tfluo*(dndt_pump(i_p,i_z)-dndt_ASE(i_p,i_z))*(1-exp(-time_int/crystal.tfluo))+beta_cell(i_p,i_z)*exp(-time_int/crystal.tfluo);
beta_cell(i_p,i_z) = crystal.tfluo*(dndt_pump(i_p,i_z)-dndt_ASE(i_p,i_z))*(1-exp(-time_int/crystal.tfluo))+beta_cell(i_p,i_z)*exp(-time_int/crystal.tfluo);
beta_cell(i_p,i_z) = crystal.tfluo*(dndt_pump(i_p,i_z)-dndt_ASE(i_p,i_z))*(1-exp(-time_int/crystal.tfluo))+beta_cell(i_p,i_z)*exp(-time_int/crystal.tfluo);
beta_cell(i_p,i_z) = crystal.tfluo*(dndt_pump(i_p,i_z)-dndt_ASE(i_p,i_z))*(1-exp(-time_int/crystal.tfluo))+beta_cell(i_p,i_z)*exp(-time_int/crystal.tfluo);
beta_cell(i_p,i_z) = crystal.tfluo*(dndt_pump(i_p,i_z)-dndt_ASE(i_p,i_z))*(1-exp(-time_int/crystal.tfluo))+beta_cell(i_p,i_z)*exp(-time_int/crystal.tfluo);
beta_cell(i_p,i_z) = crystal.tfluo*(dndt_pump(i_p,i_z)-dndt_ASE(i_p,i_z))*(1-exp(-time_int/crystal.tfluo))+beta_cell(i_p,i_z)*exp(-time_int/crystal.tfluo);
beta_cell(i_p,i_z) = crystal.tfluo*(dndt_pump(i_p,i_z)-dndt_ASE(i_p,i_z))*(1-exp(-time_int/crystal.tfluo))+beta_cell(i_p,i_z)*exp(-time_int/crystal.tfluo);
beta_cell(i_p,i_z) = crystal.tfluo*(dndt_pump(i_p,i_z)-dndt_ASE(i_p,i_z))*(1-exp(-time_int/crystal.tfluo))+beta_cell(i_p,i_z)*exp(-time_int/crystal.tfluo);
beta_cell(i_p,i_z) = crystal.tfluo*(dndt_pump(i_p,i_z)-dndt_ASE(i_p,i_z))*(1-exp(-time_int/crystal.tfluo))+beta_cell(i_p,i_z)*exp(-time_int/crystal.tfluo);
beta_cell(i_p,i_z) = crystal.tfluo*(dndt_pump(i_p,i_z)-dndt_ASE(i_p,i_z))*(1-exp(-time_int/crystal.tfluo))+beta_cell(i_p,i_z)*exp(-time_int/crystal.tfluo);
beta_cell(i_p,i_z) = crystal.tfluo*(dndt_pump(i_p,i_z)-dndt_ASE(i_p,i_z))*(1-exp(-time_int/crystal.tfluo))+beta_cell(i_p,i_z)*exp(-time_int/crystal.tfluo);
beta_cell(i_p,i_z) = crystal.tfluo*(dndt_pump(i_p,i_z)-dndt_ASE(i_p,i_z))*(1-exp(-time_int/crystal.tfluo))+beta_cell(i_p,i_z)*exp(-time_int/crystal.tfluo);
beta_cell(i_p,i_z) = crystal.tfluo*(dndt_pump(i_p,i_z)-dndt_ASE(i_p,i_z))*(1-exp(-time_int/crystal.tfluo))+beta_cell(i_p,i_z)*exp(-time_int/crystal.tfluo);
beta_cell(i_p,i_z) = crystal.tfluo*(dndt_pump(i_p,i_z)-dndt_ASE(i_p,i_z))*(1-exp(-time_int/crystal.tfluo))+beta_cell(i_p,i_z)*exp(-time_int/crystal.tfluo);
beta_cell(i_p,i_z) = crystal.tfluo*(dndt_pump(i_p,i_z)-dndt_ASE(i_p,i_z))*(1-exp(-time_int/crystal.tfluo))+beta_cell(i_p,i_z)*exp(-time_int/crystal.tfluo);
beta_cell(i_p,i_z) = crystal.tfluo*(dndt_pump(i_p,i_z)-dndt_ASE(i_p,i_z))*(1-exp(-time_int/crystal.tfluo))+beta_cell(i_p,i_z)*exp(-time_int/crystal.tfluo);
beta_cell(i_p,i_z) = crystal.tfluo*(dndt_pump(i_p,i_z)-dndt_ASE(i_p,i_z))*(1-exp(-time_int/crystal.tfluo))+beta_cell(i_p,i_z)*exp(-time_int/crystal.tfluo);
beta_cell(i_p,i_z) = crystal.tfluo*(dndt_pump(i_p,i_z)-dndt_ASE(i_p,i_z))*(1-exp(-time_int/crystal.tfluo))+beta_cell(i_p,i_z)*exp(-time_int/crystal.tfluo);
beta_cell(i_p,i_z) = crystal.tfluo*(dndt_pump(i_p,i_z)-dndt_ASE(i_p,i_z))*(1-exp(-time_int/crystal.tfluo))+beta_cell(i_p,i_z)*exp(-time_int/crystal.tfluo);
beta_cell(i_p,i_z) = crystal.tfluo*(dndt_pump(i_p,i_z)-dndt_ASE(i_p,i_z))*(1-exp(-time_int/crystal.tfluo))+beta_cell(i_p,i_z)*exp(-time_int/crystal.tfluo);
beta_cell(i_p,i_z) = crystal.tfluo*(dndt_pump(i_p,i_z)-dndt_ASE(i_p,i_z))*(1-exp(-time_int/crystal.tfluo))+beta_cell(i_p,i_z)*exp(-time_int/crystal.tfluo);
beta_cell(i_p,i_z) = crystal.tfluo*(dndt_pump(i_p,i_z)-dndt_ASE(i_p,i_z))*(1-exp(-time_int/crystal.tfluo))+beta_cell(i_p,i_z)*exp(-time_int/crystal.tfluo);
beta_cell(i_p,i_z) = crystal.tfluo*(dndt_pump(i_p,i_z)-dndt_ASE(i_p,i_z))*(1-exp(-time_int/crystal.tfluo))+beta_cell(i_p,i_z)*exp(-time_int/crystal.tfluo);
beta_cell(i_p,i_z) = crystal.tfluo*(dndt_pump(i_p,i_z)-dndt_ASE(i_p,i_z))*(1-exp(-time_int/crystal.tfluo))+beta_cell(i_p,i_z)*exp(-time_int/crystal.tfluo);
beta_cell(i_p,i_z) = crystal.tfluo*(dndt_pump(i_p,i_z)-dndt_ASE(i_p,i_z))*(1-exp(-time_int/crystal.tfluo))+beta_cell(i_p,i_z)*exp(-time_int/crystal.tfluo);
beta_cell(i_p,i_z) = crystal.tfluo*(dndt_pump(i_p,i_z)-dndt_ASE(i_p,i_z))*(1-exp(-time_int/crystal.tfluo))+beta_cell(i_p,i_z)*exp(-time_int/crystal.tfluo);
beta_cell(i_p,i_z) = crystal.tfluo*(dndt_pump(i_p,i_z)-dndt_ASE(i_p,i_z))*(1-exp(-time_int/crystal.tfluo))+beta_cell(i_p,i_z)*exp(-time_int/crystal.tfluo);
beta_cell(i_p,i_z) = crystal.tfluo*(dndt_pump(i_p,i_z)-dndt_ASE(i_p,i_z))*(1-exp(-time_int/crystal.tfluo))+beta_cell(i_p,i_z)*exp(-time_int/crystal.tfluo);
beta_cell(i_p,i_z) = crystal.tfluo*(dndt_pump(i_p,i_z)-dndt_ASE(i_p,i_z))*(1-exp(-time_int/crystal.tfluo))+beta_cell(i_p,i_z)*exp(-time_int/crystal.tfluo);
beta_cell(i_p,i_z) = crystal.tfluo*(dndt_pump(i_p,i_z)-dndt_ASE(i_p,i_z))*(1-exp(-time_int/crystal.tfluo))+beta_cell(i_p,i_z)*exp(-time_int/crystal.tfluo);
beta_cell(i_p,i_z) = crystal.tfluo*(dndt_pump(i_p,i_z)-dndt_ASE(i_p,i_z))*(1-exp(-time_int/crystal.tfluo))+beta_cell(i_p,i_z)*exp(-time_int/crystal.tfluo);
beta_cell(i_p,i_z) = crystal.tfluo*(dndt_pump(i_p,i_z)-dndt_ASE(i_p,i_z))*(1-exp(-time_int/crystal.tfluo))+beta_cell(i_p,i_z)*exp(-time_int/crystal.tfluo);
beta_cell(i_p,i_z) = crystal.tfluo*(dndt_pump(i_p,i_z)-dndt_ASE(i_p,i_z))*(1-exp(-time_int/crystal.tfluo))+beta_cell(i_p,i_z)*exp(-time_int/crystal.tfluo);
beta_cell(i_p,i_z) = crystal.tfluo*(dndt_pump(i_p,i_z)-dndt_ASE(i_p,i_z))*(1-exp(-time_int/crystal.tfluo))+beta_cell(i_p,i_z)*exp(-time_int/crystal.tfluo);
beta_cell(i_p,i_z) = crystal.tfluo*(dndt_pump(i_p,i_z)-dndt_ASE(i_p,i_z))*(1-exp(-time_int/crystal.tfluo))+beta_cell(i_p,i_z)*exp(-time_int/crystal.tfluo);
beta_cell(i_p,i_z) = crystal.tfluo*(dndt_pump(i_p,i_z)-dndt_ASE(i_p,i_z))*(1-exp(-time_int/crystal.tfluo))+beta_cell(i_p,i_z)*exp(-time_int/crystal.tfluo);
beta_cell(i_p,i_z) = crystal.tfluo*(dndt_pump(i_p,i_z)-dndt_ASE(i_p,i_z))*(1-exp(-time_int/crystal.tfluo))+beta_cell(i_p,i_z)*exp(-time_int/crystal.tfluo);
beta_cell(i_p,i_z) = crystal.tfluo*(dndt_pump(i_p,i_z)-dndt_ASE(i_p,i_z))*(1-exp(-time_int/crystal.tfluo))+beta_cell(i_p,i_z)*exp(-time_int/crystal.tfluo);
beta_cell(i_p,i_z) = crystal.tfluo*(dndt_pump(i_p,i_z)-dndt_ASE(i_p,i_z))*(1-exp(-time_int/crystal.tfluo))+beta_cell(i_p,i_z)*exp(-time_int/crystal.tfluo);
beta_cell(i_p,i_z) = crystal.tfluo*(dndt_pump(i_p,i_z)-dndt_ASE(i_p,i_z))*(1-exp(-time_int/crystal.tfluo))+beta_cell(i_p,i_z)*exp(-time_int/crystal.tfluo);
beta_cell(i_p,i_z) = crystal.tfluo*(dndt_pump(i_p,i_z)-dndt_ASE(i_p,i_z))*(1-exp(-time_int/crystal.tfluo))+beta_cell(i_p,i_z)*exp(-time_int/crystal.tfluo);
beta_cell(i_p,i_z) = crystal.tfluo*(dndt_pump(i_p,i_z)-dndt_ASE(i_p,i_z))*(1-exp(-time_int/crystal.tfluo))+beta_cell(i_p,i_z)*exp(-time_int/crystal.tfluo);
beta_cell(i_p,i_z) = crystal.tfluo*(dndt_pump(i_p,i_z)-dndt_ASE(i_p,i_z))*(1-exp(-time_int/crystal.tfluo))+beta_cell(i_p,i_z)*exp(-time_int/crystal.tfluo);
beta_cell(i_p,i_z) = crystal.tfluo*(dndt_pump(i_p,i_z)-dndt_ASE(i_p,i_z))*(1-exp(-time_int/crystal.tfluo))+beta_cell(i_p,i_z)*exp(-time_int/crystal.tfluo);